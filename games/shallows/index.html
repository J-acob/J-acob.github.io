<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  The Shallows · Jacob&#39;s portfiolio website
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Jacob Cheney">
<meta name="description" content="A top-down pixel-shmup dungeon crawler roguelite built in rust using the Bevy game engine">
<meta name="keywords" content="blog,developer,personal,gamedev,indiedev">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Shallows"/>
<meta name="twitter:description" content="A top-down pixel-shmup dungeon crawler roguelite built in rust using the Bevy game engine"/>

<meta property="og:title" content="The Shallows" />
<meta property="og:description" content="A top-down pixel-shmup dungeon crawler roguelite built in rust using the Bevy game engine" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://j-acob.github.io/games/shallows/" /><meta property="article:section" content="games" />
<meta property="article:published_time" content="2023-08-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-08-17T00:00:00+00:00" />





<link rel="canonical" href="https://j-acob.github.io/games/shallows/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.70396ce36539e306500d9bc8e96f6d4471830c33a22c25e6fda45cc7626d11ae.css" integrity="sha256-cDls42U54wZQDZvI6W9tRHGDDDOiLCXm/aRcx2JtEa4=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css" integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin="anonymous" media="screen" />
  



 


  
  
    
    <link rel="stylesheet" href="/scss/custom.min.de6b6ba2a194481f03e6073245b7505fe8ae58887adf93ed7b0dbbb9db0bb640.css" integrity="sha256-3mtroqGUSB8D5gcyRbdQX&#43;iuWIh635Ptew27udsLtkA=" crossorigin="anonymous" media="screen" />
  



<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.103.1" />




  </head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Jacob&#39;s portfiolio website
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/games/">Games</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/contact/">Contact me</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      

<script type="module">
    import { progressiveFetch } from '/js/tools.js'; 
    import init from '/js/shallows.js';

    const canvasEl = document.getElementById('bevy');
    const progressStatusEl = document.querySelector('[data-progress-status]');
    const progressFileEl = document.querySelector('[data-progress-file]');
    const progressBarEl = document.querySelector('[data-progress-bar]');
    let hideProgressTimeoutId;

    async function loadingBarFetch(resource) {
        return progressiveFetch(resource, {
            start: ({ filename }) => {
                progressStatusEl.style.display = 'block';
                progressFileEl.textContent = filename;

                if (hideProgressTimeoutId) {
                    clearTimeout(hideProgressTimeoutId);
                }
            },
            update: ({ isIndeterminate, loadedPercent }) => {
                progressBarEl.classList.toggle('bevy-instance__progress-bar--indeterminate', isIndeterminate);
                progressBarEl.style.width = loadedPercent + '%';
            },
            finish: () => {
                
                
                
                
                
                hideProgressTimeoutId = setTimeout(() => {
                    progressStatusEl.style.display = 'none';
                }, 49);
            }
        })
    }
    window.bevyLoadingBarFetch = loadingBarFetch;
    init();
</script>
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://j-acob.github.io/games/shallows/">
              The Shallows
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2023-08-17T00:00:00Z">
                August 17, 2023
              </time>
            </span>
          </div>
          <div class="authors">
  <i class="fa fa-user" aria-hidden="true"></i>
    <a href="/authors/jacob-cheney/">Jacob Cheney</a></div>

          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="/categories/gamdev/">gamdev</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/game/">game</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/graphics/">graphics</a>
    </span></div>

        </div>
      </header>


      
      <div class="example__canvas bevy-instance">
          <div class="bevy-instance__progress-status" data-progress-status>
              <div class="bevy-instance__progress-file" data-progress-file></div>
              <div class="bevy-instance__progress-track">
                  <div class="bevy-instance__progress-bar" data-progress-bar></div>
              </div>
          </div>
          <canvas class="bevy-instance__canvas" id="bevy" width="1280" height="720"></canvas>
      </div>

      <p>
        A top-down pixel-shmup dungeon crawler roguelite built in rust using the Bevy game engine
      </p>

        
      
      <div class="post-content">
        
        <h2 id="controls">
  Controls
  <a class="heading-link" href="#controls">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Movement - WASD
Shooting - Mouse + Click
UI - Press esc to navigate &ldquo;back&rdquo; in any given ui state</p>
<hr>
<p>This is a pre-pre-alpha demo version of a game I&rsquo;ve been working on as a way to learn Rust on a more intricate level. The gameplay is very barebones right now. A single level with some enemies, once you kill them all - you win.</p>
<h2 id="bevyhttpsbevyengineorg">
  <a href="https://bevyengine.org/">Bevy</a>
  <a class="heading-link" href="#bevyhttpsbevyengineorg">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Bevy is a really amazing project built by a ton of cool people. It&rsquo;s also one of few engines I&rsquo;ve tried that fits all my requirements whenever I would want to sit down and &ldquo;make a game&rdquo;. The amount of control and flexibility you get with an ECS framework is staggering. This also poses a cognitive challenge as well though. I&rsquo;m mostly used to OOP but have come to prefer data oriented paradigms as the complexities of my projects grow in size.</p>
<p>Unfortunately, the game currently isn&rsquo;t open source as some of the assets I use(d) require me to project them when distributing. I&rsquo;m in the process of trying to find alternative assets or make my own so I can potentially open source the project in the future. I don&rsquo;t have any solid plans on monetizing this project but that may change in the future.</p>
<p>Making full use of bevy for sure requires some intimate knowlege of rust - especially generics. However, the open source nature of bevy makes it extraordinarily easy to just go into the source code and dig into the internals of how something works. You can&rsquo;t do that with other engines unless you (usually) pay a premium to access source code.</p>
<p>The community is also really fast and adaptable as well. This game has been through 3 whole releases of the bevy engine (0.9-&gt;0.11.1) and each time I&rsquo;ve managed to upgrade with extreme ease because you can easily point any depedencies towards a specific git branch if need be.</p>
<p>However - there are some points of pain that took me time to get used to.</p>
<p>The asset management system is not fully matured yet and required me to use third party crates which took a bit of getting used to. However, <a href="https://github.com/bevyengine/bevy/pull/8624">AssetsV2</a> should hit soon.</p>
<p>Implementing physics was challenging since I ended up relying on <a href="https://rapier.rs/">Rapier</a> for physics. Rapier is very good but I had to do some custom scheduling of systems to smoothly integrate everything.</p>
<p>Animations took me the longest amount of time because I was just getting comfortable with rust generics around the time I needed a way to make animations&hellip; well &hellip; generic. I decided to use <a href="https://github.com/Leafwing-Studios/leafwing-input-manager">Leafwing Input Manager</a> to handle all the inputs. But I needed a way to somehow &ldquo;map&rdquo; animations to actions. Or at least associate them somehow. Animations are stored in handles and so I ended up (after a lot of trial and error) using a trait for this.</p>
<p>It looks a bit like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="font-weight:bold">pub</span> <span style="font-weight:bold">trait</span> ActionAnimationMapping: <span style="font-weight:bold">Actionlike</span> + Copy {
</span></span><span style="display:flex;"><span>    <span style="font-style:italic">///Get the animation data handle for this action
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>    <span style="font-weight:bold">fn</span> get_animation_data_handle(
</span></span><span style="display:flex;"><span>        &amp;self,
</span></span><span style="display:flex;"><span>        action_state: <span style="">&amp;</span><span style="font-weight:bold">ActionState</span>&lt;Self&gt;,
</span></span><span style="display:flex;"><span>        animation_maps: <span style="">&amp;</span><span style="font-weight:bold">AnimationActionMap</span>,
</span></span><span style="display:flex;"><span>    ) -&gt; Option&lt;Handle&lt;AnimationData&gt;&gt;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-style:italic">/// Get the animation data for the animation which this one should transition into
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>    <span style="font-weight:bold">fn</span> get_animation_transition_data_handle(
</span></span><span style="display:flex;"><span>        &amp;self,
</span></span><span style="display:flex;"><span>        action_state: <span style="">&amp;</span><span style="font-weight:bold">ActionState</span>&lt;Self&gt;,
</span></span><span style="display:flex;"><span>        animation_maps: <span style="">&amp;</span><span style="font-weight:bold">AnimationActionMap</span>,
</span></span><span style="display:flex;"><span>    ) -&gt; Option&lt;Handle&lt;AnimationData&gt;&gt;;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This allows me to very easily observe whatever <code>ActionState</code> an entity is in and grab a given animation when I need to. I would probably try and find a different way to do this now that I&rsquo;m more comfortable with ECS in general that wouldn&rsquo;t require so much fetching of things out of resources.</p>
<p>Overall - bevy is the best game engine I&rsquo;ve used thus far (yes I have used unity, godot, etc) just because of the potential it has and the current ergonomics it provides. Being able to write a game 100% in rust is very powerful.</p>
<p>As for the future of this little demo&hellip; I&rsquo;m not sure if I&rsquo;m too keen on starting a entirely new project and might end up waiting until Bevy has stabilized a bit with how it handles assets. However, I don&rsquo;t really see myself using any other game engine for (personal) projects. I might continue to hack away at this project and get some much needed polish/features on it. Who knows!</p>

      </div>


      

      <footer>
        


        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2023
     Jacob Cheney 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  
</body>

</html>
